---
import { type CollectionEntry, getCollection } from "astro:content";
import dayjs from "dayjs";
import Layout from "../../../layouts/layout.astro";

interface Props {
  post: CollectionEntry<"posts">;
}

export async function getStaticPaths() {
  const allPosts = await getCollection("posts");
  return allPosts.map((post) => ({
    params: {
      slug: post.slug,
    },
    props: {
      post,
    },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width" />
  <link rel="icon" href="/favicon.svg" />
  <meta name="description" content={post.data.title} />
  <meta property="twitter:title" content=" shivam " />
  <meta
    name="twitter:image"
    content="https://shivam.ing/images/opengraph-image.png"
  />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@shivamhwp" />
  <meta property="og:title" content={post.data.title || ""} />
  <meta property="og:description" content={post.data.title} />
  <meta property="og:site_name" content="shivam.ing" />
  <meta property="og:url" content="https://www.shivam.ing" />
  <meta
    property="og:image"
    content="https://shivam.ing/images/opengraph-image.png"
  />
  <title>{post.data.title || ""}</title>
</head>
<Layout>
  <article class="space-y-6">
    <header class="space-y-2">
      <div
        class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4"
      >
        <div class="flex-1 min-w-0">
          <h1 class="text-foreground text-base font-normal mb-2">
            {post.data.title}
          </h1>
          <time
            class="text-muted-foreground text-xs"
            datetime={post.data.published.toISOString()}
          >
            {dayjs(post.data.published).format("MMM D, YYYY")}
          </time>
        </div>
        {
          post.data.director && (
            <div class="shrink-0 text-right sm:text-left">
              <div class="text-muted-foreground text-xs mb-1">
                director
              </div>
              <div class="text-foreground text-xs font-normal">
                {post.data.director}
              </div>
            </div>
          )
        }
      </div>
    </header>
    <div
      class="text-muted-foreground w-full text-sm leading-relaxed [&_h1]:font-normal [&_h1]:text-foreground [&_h1]:mt-6 [&_h1]:mb-3 [&_h1]:text-sm [&_h2]:font-normal [&_h2]:text-foreground [&_h2]:mt-6 [&_h2]:mb-3 [&_h2]:text-sm [&_h3]:font-normal [&_h3]:text-foreground [&_h3]:mt-6 [&_h3]:mb-3 [&_h3]:text-sm [&_h4]:font-normal [&_h4]:text-foreground [&_h4]:mt-6 [&_h4]:mb-3 [&_h4]:text-sm [&_p]:mb-4 [&_p]:text-sm [&_p]:leading-relaxed [&_a]:text-foreground [&_a]:underline [&_a]:underline-offset-2 [&_a]:decoration-1 [&_a]:transition-opacity [&_a:hover]:opacity-80 [&_ul]:mb-4 [&_ul]:pl-4 [&_ul]:space-y-1 [&_ol]:mb-4 [&_ol]:pl-4 [&_ol]:space-y-1 [&_li]:mb-1 [&_li]:leading-relaxed [&_li]:marker:text-muted-foreground [&_code]:font-mono [&_code]:text-xs [&_code]:bg-muted-foreground/10 [&_code]:px-1 [&_code]:py-0.5 [&_code]:rounded [&_pre]:font-mono [&_pre]:overflow-x-auto [&_pre]:mb-4 [&_pre]:p-3 [&_pre]:bg-muted-foreground/5 [&_pre]:rounded [&_pre]:border [&_pre]:border-muted-foreground/20 [&_pre_code]:bg-transparent [&_pre_code]:p-0 [&_blockquote]:border-l-2 [&_blockquote]:border-muted-foreground/30 [&_blockquote]:pl-4 [&_blockquote]:italic [&_blockquote]:text-muted-foreground [&_blockquote]:my-4 [&_hr]:border-muted-foreground/20 [&_hr]:my-6 [&_img]:rounded [&_img]:my-4 [&_img]:w-full [&_img]:h-auto [&_strong]:font-normal [&_strong]:text-foreground [&_em]:italic [&_table]:w-full [&_table]:mb-4 [&_table]:border-collapse [&_table]:text-xs [&_th]:border [&_th]:border-muted-foreground/20 [&_th]:px-2 [&_th]:py-1 [&_td]:border [&_td]:border-muted-foreground/20 [&_td]:px-2 [&_td]:py-1 [&_th]:font-normal [&_th]:bg-muted-foreground/5"
    >
      <Content />
    </div>
    <footer class="pt-4 pb-8">
      <a
        href="/writings"
        class="text-muted-foreground hover:text-foreground transition-colors inline-flex items-center gap-2 text-xs no-underline"
      >
        <span>‚Üê</span>
        <span>back</span>
      </a>
    </footer>
  </article>
</Layout>
